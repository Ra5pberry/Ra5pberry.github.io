(function(){"use strict";var e={4490:function(e,t,n){var a=n(9242),r=n(3396);const o={id:"app",class:"wrapper"},l={class:"app-header"},i={class:"select"},s={class:"update-btn"},c={class:"graph"};function p(e,t,n,a,p,d){const u=(0,r.up)("HeaderComponent"),f=(0,r.up)("PrefSelect"),h=(0,r.up)("PopulationGraph");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r._)("div",l,[(0,r.Wm)(u)]),(0,r._)("div",i,[(0,r.Wm)(f,{onEmmitedSelectedPrefs:t[0]||(t[0]=t=>e.receivedSelectedPrefs=t)})]),(0,r._)("div",s,[(0,r._)("a",{class:"update-btn",onClick:t[1]||(t[1]=(...t)=>e.getPopulation&&e.getPopulation(...t))},"更新")]),(0,r._)("div",c,[(0,r.Wm)(h,{ref:"graph","selected-population-data":e.populationData},null,8,["selected-population-data"])])])}var d=n(7139);const u=(0,r._)("div",{class:"div-header"},[(0,r._)("p",null,"都道府県")],-1),f={class:"select-wrapper"},h=["for","id","name"],v=["id","value"];function m(e,t,n,o,l,i){return(0,r.wg)(),(0,r.iD)(r.HY,null,[u,(0,r._)("div",f,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.prefData,((n,o)=>((0,r.wg)(),(0,r.iD)("span",{class:"pref-select",key:o},[(0,r._)("label",{class:"pref-checkbox",for:"pref"+o,id:"label"+n.prefCode,name:n.prefName},[(0,r.wy)((0,r._)("input",{id:"pref"+o,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedPrefs=t),type:"checkbox",value:n.prefCode,onChange:t[1]||(t[1]=(0,a.iM)((t=>e.sendPrefs()),["stop"]))},null,40,v),[[a.e8,e.selectedPrefs]]),(0,r.Uk)(" "+(0,d.zw)(n.prefName),1)],8,h)])))),128))])],64)}var g=n(6265),b=n.n(g);const P="XFL3yNTPMS93qg2XO4zkHdTAEjCJnD4YDkDpnC2T",y=b().create();y.interceptors.request.use((e=>(e.headers={"X-API-KEY":P},e)));var w=y;const C="https://opendata.resas-portal.go.jp/";let D,_=[],O=[];var k=(0,r.aZ)({name:"PrefSelect",data(){return{prefData:D,selectedPrefs:_,populationData:O}},watch:{selectedPrefs:{handler:function(e){console.log("selected Pref is changed"),console.log(e)}}},created(){this.getPrefs()},emits:["emmited-selected-prefs"],methods:{getPrefs(){w.get(`${C}api/v1/prefectures`).then((e=>{this.prefData=Object.assign({},this.prefData,e.data.result)})).catch((e=>{console.error(e)}))},sendPrefs(){let e=[{prefCode:0,prefName:""}];e.pop(),this.selectedPrefs.forEach((t=>{var n,a=null===(n=document.getElementById(`label${t}`))||void 0===n?void 0:n.innerHTML;let r={prefCode:t,prefName:a.substring(a.indexOf(">")+1)};e.push(r)})),console.log(e),this.$emit("emmited-selected-prefs",e)}}}),j=n(89);const E=(0,j.Z)(k,[["render",m]]);var x=E;const S={id:"population-graph"},Z=(0,r._)("canvas",{id:"myChart",width:"400",height:"400"},null,-1),A=[Z];function M(e,t,n,a,o,l){return(0,r.wg)(),(0,r.iD)("div",S,A)}var N=n(4851);const $=["1960","1965","1970","1975","1980","1985","1990","1995","2000","2005","2010","2015","2020","2025","2030","2035","2040","2045"];var H=(0,r.aZ)({name:"PopulationGraph",props:{selectedPopulationData:{type:Array}},watch:{selectedPopulationData:{handler:function(){var e;let t=[{label:"",data:[0]}];t.pop(),null===(e=this.selectedPopulationData)||void 0===e||e.forEach((e=>{let n={label:e.label,data:e.data,borderColor:`rgb(${255*Math.random()}, ${255*Math.random()},\n                          ${255*Math.random()})`};t.push(n)}));let n=document.getElementById("population-graph");while(null===n||void 0===n?void 0:n.lastChild)n.removeChild(n.lastChild);var a=document.createElement("canvas");a.setAttribute("id","myChart"),null===n||void 0===n||n.appendChild(a);let r=document.getElementById("myChart");new N.Z(r,{type:"line",data:{labels:$,datasets:t}})}}}});const T=(0,j.Z)(H,[["render",M]]);var Y=T;const I=(0,r._)("h1",null,[(0,r._)("p",null,"都道府県別人口推移グラフ")],-1),B=[I];function F(e,t){return(0,r.wg)(),(0,r.iD)("header",null,B)}const G={},W=(0,j.Z)(G,[["render",F]]);var X=W,q=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function l(e){try{s(a.next(e))}catch(t){o(t)}}function i(e){try{s(a["throw"](e))}catch(t){o(t)}}function s(e){e.done?n(e.value):r(e.value).then(l,i)}s((a=a.apply(e,t||[])).next())}))};const z="https://opendata.resas-portal.go.jp/";var K=(0,r.aZ)({name:"App",components:{PrefSelect:x,PopulationGraph:Y,HeaderComponent:X},data(){return{receivedSelectedPrefs:[{prefCode:0,prefName:""}],populationData:{label:"",data:[0]},resetFlg:!1}},prop:["chartData"],methods:{getPopulation(){return q(this,void 0,void 0,(function*(){let e=[{label:"",data:[]}];e.pop();for(let n of this.receivedSelectedPrefs){var t={label:"",data:[0]};t.label=n.prefName,yield w.get(`${z}api/v1/population/composition/perYear`,{params:{prefCode:n.prefCode,cityCode:"-"}}).then((n=>{var a=[];for(const[e,t]of Object.entries(n.data.result))Array.isArray(t)&&t[0].data.forEach((e=>{a.push(e.value)}));t.data=a,console.log(t.data),e[Object.keys(e).length]=t})).catch((e=>{console.error(e)}))}this.populationData=e}))}}});const L=(0,j.Z)(K,[["render",p]]);var U=L;const J=(0,a.ri)(U);J.mount("#app")}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,a,r,o){if(!a){var l=1/0;for(p=0;p<e.length;p++){a=e[p][0],r=e[p][1],o=e[p][2];for(var i=!0,s=0;s<a.length;s++)(!1&o||l>=o)&&Object.keys(n.O).every((function(e){return n.O[e](a[s])}))?a.splice(s--,1):(i=!1,o<l&&(l=o));if(i){e.splice(p--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var p=e.length;p>0&&e[p-1][2]>o;p--)e[p]=e[p-1];e[p]=[a,r,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,o,l=a[0],i=a[1],s=a[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(s)var p=s(n)}for(t&&t(a);c<l.length;c++)o=l[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(p)},a=self["webpackChunkpopulation_graph"]=self["webpackChunkpopulation_graph"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(4490)}));a=n.O(a)})();
//# sourceMappingURL=app.ff293d50.js.map